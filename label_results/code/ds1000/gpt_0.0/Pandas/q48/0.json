{"trg_prediction": "# First, select the rows whose value is bigger than the threshold\nbig_rows = df.loc[df['value'] >= thresh]\n\n# If there are no big rows, return the original dataframe\nif big_rows.empty:\n    result = df\nelse:\n    # Calculate the average of the big rows\n    avg_value = big_rows['value'].mean()\n\n    # Create a new row with the average value and a new label\n    new_row = pd.DataFrame({'value': [avg_value]}, index=['X'])\n\n    # Drop the big rows from the original dataframe\n    df = df.drop(big_rows.index)\n\n    # Concatenate the new row and the remaining rows\n    result = pd.concat([df, new_row])\nEND SOLUTION\n"}
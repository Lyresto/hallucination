result = np.maximum.reduceat(a, np.unique(index))

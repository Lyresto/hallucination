{"trg_prediction": "import tensorflow as tf\n\nx = [[[[1, 2, 3], [2, 3, 4], [0, 0, 0]],\n      [[1, 2, 3], [2, 0, 4], [3, 4, 5]],\n      [[1, 2, 3], [0, 0, 0], [0, 0, 0]],\n      [[1, 2, 3], [1, 2, 3], [0, 0, 0]]],\n     [[[1, 2, 3], [0, 1, 0], [0, 0, 0]],\n      [[1, 2, 3], [2, 3, 4], [0, 0, 0]],\n      [[1, 2, 3], [0, 0, 0], [0, 0, 0]],\n      [[1, 2, 3], [1, 2, 3], [1, 2, 3]]]]\nx = tf.convert_to_tensor(x, dtype=tf.float32)\n\n# Count the number of non-zero entries in each batch\nnon_zero_counts = tf.math.count_nonzero(x, axis=-1)\n\n# Calculate the sum of non-zero entries in each batch\nsum_non_zero = tf.reduce_sum(x, axis=-1)\n\n# Divide the sum by the count to get the average\nresult = tf.divide(sum_non_zero, non_zero_counts)\n\nresult"}
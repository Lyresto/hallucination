{"trg_prediction": "from collections import Counter\nimport numpy as np\n\ndef fit_multinomial(df, weights):\n\tn = len(df)\n\t\n\tdist = np.array([[0] * n for i in range(n)])\n\t\n\tfor i in range(n):\n\t\tfor j in range(n):\n\t\t\tdist[i][j] = np.sum(df[i == j]) / (df[i].count(j) * weights[j])\n\t\n\tres = np.array([dist[i][j] for i in range(n) for j in range(n)])\n\t\n\treturn res, dist\n\t\ndef multinomial_probability(df, weights):\n\tres, dist = fit_multinomial(df, weights)\n\treturn res\n"}
{"trg_prediction": "# First, we need to count the number of non-zero entries in the second to last dimension\nnum_nonzero = tf.math.count_nonzero(x, axis=-2, dtype=tf.float32)\n\n# Next, we need to set the zero entries to 1 to avoid division by zero\nmask = tf.cast(tf.not_equal(num_nonzero, 0), dtype=tf.float32)\nnum_nonzero += mask\n\n# Now, we can calculate the sum of the non-zero entries\nsum_nonzero = tf.reduce_sum(x, axis=-2)\n\n# Finally, we can divide the sum by the number of non-zero entries\nresult = sum_nonzero / num_nonzero\n\n# Apply the mask to set the zero entries to 0\nresult *= mask\n"}
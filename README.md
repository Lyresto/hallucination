## Overview of file structure
The custom parameters required for code execution are all provided in ` if _ name__=='main__ ': `.
- [code_judge_tools](##code_judge_tools) Code evaluation for two datasets and sampling tool for DS 1000 questions
- [label_results](##label_results) Code annotation related, including questions, generated code, annotation results, etc
- [data_score](##data_score) Trainers, generators, etc. for code hallucination scoring models
- [inject](##inject) Relevant documents for hallucination injection, including screening of questions, allocation of hallucination types, and calling of rules and large models
- [generate_results](##generate_results) The result of generating hallucinatory code
- [result](##result) The final benchmark dataset obtained

## code_judge_tools

1. ds1000_code_judge.py
    - Used to evaluate the generated code for the ds 1000 dataset
    
    -  |   Parameter Name   |   Parameter Value   |
        | :--: | :--: |
        |   base_dir   |  The folder where the DS-1000 dataset is located    |
        |    model  |   What model is the code being evaluated generated by   |
    
2. ds1000_sample.py
    - Used to sample the code generated from the ds 1000 dataset
    - |   Parameter Name   |   Parameter Value   |
      | :--: | :--: |
      |  base_dir  | The folder where the DS-1000 dataset is located |
      | sample_ref_model | Based on which model to generate code for sampling (can be empty)|
       | answer_ref_model | Which model folder to use ans.pkl (can be empty)|
       | model | What model generated the sampled code |
       | sample_rate | sampling rate |
   
3. humaneval_code_judge.py
    - Used to evaluate the generated code for the human eval dataset
    -  |   Parameter Name   |   Parameter Value   |
        | :--: | :--: |
        |   base_project_dir   |  The folder where the humaneval dataset is located    |
        |    completion_file  |   The file where the generated code is located   |

## label_results
1. code
   - All code generated by the model
2. judge
   - Code evaluation results
3. problem
   - Dataset file
4. result
   - Annotation results of code
5. merge_data.py
   - Used to combine the above data into a large JSON file
   - |   Parameter Name   |   Parameter Value   |
      | :--: | :--: |
      | single | Is it possible to only take one copy of the generated code for each model |
6. merged_data.json
   - Data files generated from all data
7. merged_data_single.json
   - Each model only takes one copy of the data file generated during code generation

## data_score
1. models
    - Model weight file for code scoring

2. code_scoring.py
   - Used for generating training data for scoring models
   - |   Parameter Name   |   Parameter Value   |
      | :--: | :--: |
      |   result_path   |  Result save file path    |

3. score_data_7.json
   - Data used for training scoring models

4. score_generate.py
   - Used for scoring basic dataset code
   - |   Parameter Name   |   Parameter Value   |
      | :--: | :--: |
      |   base_dataset   |  Basic dataset file path    |
      | score_model | Scoring model weight file path |

5. score_trainer.py
   - Used for training scoring models
   - |   Parameter Name   |   Parameter Value   |
      | :--: | :--: |
      | input_size | Code pairs feature quantity |
      | num_classes | Number of hallucination types |
      | hidden_size | Hidden layer size |
      | batch_size | Batch size |
      | num_epochs | Training rounds |
      | lr | Learning rate |
      | data_version | Data version |

## inject
1. builtins.json
   - A tool file that saves all built-in functions and objects in Python
2. code_alpaca_20k.json
   - Basic dataset
3. code_alpaca_20k_filtered_7.json
   - Basic dataset after filtering
4. code_distribute.py
   - Allocation for hallucination types
   - |   Parameter Name   |   Parameter Value   |
      | :--: | :--: |
      | data_source | Filtered basic dataset path |
5. data_filter.py
   - Used for filtering basic datasets
   - |   Parameter Name   |   Parameter Value   |
      | :--: | :--: |
      | output_file | Result output file path |
6. hallucination_inject.py
   - Main file for code hallucination injection
   - |   Parameter Name   |   Parameter Value   |
      | :--: | :--: |
      | data_source | Filtered basic dataset path |
      |result_path | Result save path|
7. hallucination_methods_logic.py
   - Method function file for code hallucination injection
8. identifiers_all.json
   - Tool file that saves all variable names in the basic dataset code
9. make_restrict.py
   - Provide additional limitations for assigning hallucination types
   - |   Parameter Name   |   Parameter Value   |
      | :--: | :--: |
      | data_source | Filtered basic dataset path |
10. methods.json
   - Method configuration for injecting different types of hallucinations

## generate_results
1. generate1.json
   - Hallucinatory codes generated for the basic dataset (using the large model method, five candidate codes were generated for each question)
2. generate1_filter3.json
   - The file obtained by selecting one of the 5 candidate codes in the corresponding question of the large model method

## result
1. Hall-Code.json
   - The final dataset file obtained
2. merge.py
   - Used to merge the basic dataset with the generated hallucination code
   - |   Parameter Name   |   Parameter Value   |
      | :--: | :--: |
      | data_source | Filtered basic dataset path |
      |generate_results| The generated hallucination code file|
      |result_path | Result save path|